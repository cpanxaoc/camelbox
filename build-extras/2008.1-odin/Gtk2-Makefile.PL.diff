--- Makefile.PL.orig	Sun Jul 20 02:20:22 2008
+++ Makefile.PL	Tue Jul 22 00:34:57 2008
@@ -28,6 +28,7 @@
 use ExtUtils::MakeMaker;
 use File::Spec;
 use Cwd;
+use Config;
 
 # minimum required version of dependencies we need to build
 our %build_reqs = (
@@ -231,7 +232,13 @@
 # the autogenerated files.  we do this kindof as a public service to client
 # modules, as these will carry through via the depends mechanism.
 $gtk2->set_inc ($pkgcfg_gtk{cflags} . ' -I./build ');
-$gtk2->set_libs ($pkgcfg_gtk{libs});
+# add extra Windows import library crunchy goodness
+if ( $^O =~ /Win32/ ) {
+	$gtk2->set_libs (q(-L) . $Config{bin} . q( ) . $pkgcfg_gtk{libs} 
+		. q(-lGlibPerl -lCairoPerl));
+} else {
+	$gtk2->set_libs ($pkgcfg_gtk{libs});
+}
 $gtk2->add_pm (%pm_files);
 $gtk2->add_xs (@xs_files);
 my $cwd = cwd();
@@ -303,6 +310,16 @@
 #
 # extra makefile override stuff... watch for falling wizardry.
 #
+
+# hopefully you have dynamic_lib disabled in Glib::MakeHelper, or this won't
+# get fired :(
+sub MY::dynamic_lib {
+	my $inherited = shift->SUPER::dynamic_lib(@_);
+	$inherited .= "\tdlltool --input-def Gtk2.def --dllname Gtk2.dll \\\n";
+	$inherited .= "\t\t--output-lib libGtk2Perl.a\n";
+	$inherited .= "\t\$(CP) libGtk2Perl.a " . $Config{libpth} . "\n";
+	return $inherited;
+}
 
 sub MY::postamble
 {
